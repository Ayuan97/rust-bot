# 🚀 快速上手指南

## 第一步：安装依赖

### 方式一：使用启动脚本（推荐）

```bash
./start.sh
```

脚本会自动：
- 检查并安装依赖
- 创建配置文件
- 启动前后端服务

### 方式二：手动安装

```bash
# 安装后端依赖
cd backend
npm install

# 安装前端依赖
cd ../frontend
npm install
```

## 第二步：配置环境变量

### 后端配置 (`backend/.env`)

```env
PORT=3000
FRONTEND_URL=http://localhost:5173
```

### 前端配置 (`frontend/.env`)

```env
VITE_API_URL=http://localhost:3000/api
VITE_SOCKET_URL=http://localhost:3000
```

> 💡 如果使用启动脚本，这些文件会自动创建

## 第三步：启动服务

### 使用启动脚本

```bash
./start.sh
```

### 手动启动

**终端 1 - 启动后端：**
```bash
cd backend
npm run dev
```

**终端 2 - 启动前端：**
```bash
cd frontend
npm run dev
```

## 第四步：配对服务器

### 1. 访问 Dashboard

打开浏览器访问：http://localhost:5173

### 2. 启动配对监听

- 点击顶部 **"配对服务器"** 按钮
- 点击 **"启动配对监听"** 按钮
- 等待提示 "等待游戏内配对..."

### 3. 游戏内配对

在 Rust 游戏中：
1. 进入任意服务器
2. 按 `ESC` 打开菜单
3. 点击右下角 **Rust+** 图标
4. 点击 **"Pair with Server"**

### 4. 完成！

- 配对成功后会弹出提示
- 服务器会自动添加到列表
- 系统会自动连接
- 现在可以使用所有功能了！

## 核心功能使用

### 📨 发送消息到游戏

1. 确保服务器已连接（状态显示"在线"）
2. 在右侧 **"队伍聊天"** 面板输入消息
3. 点击 **"发送"** 按钮
4. 消息会发送到游戏内队伍聊天

### 🔌 控制智能设备

**方式一：游戏内配对（推荐）**
1. 在游戏中对着智能设备（灯、开关、门等）
2. 按住 `E` 键
3. 点击 **"Pair"** 按钮
4. 设备会自动添加到 Dashboard

**方式二：手动添加**
1. 点击 **"添加设备"** 按钮
2. 输入设备 ID（Entity ID）和名称
3. 点击 **"确认添加"**

**控制设备**
- 点击设备卡片上的 **开关按钮** 控制设备
- 点击 **刷新按钮** 更新设备状态
- 设备状态会实时同步

### 📊 查看服务器信息

选择已连接的服务器后，可以看到：
- 在线玩家数量
- 地图信息
- 游戏时间（白天/夜晚）
- 队伍成员列表

## 常见问题排查

### ❌ 端口被占用

如果端口 3000 或 5173 被占用，修改配置文件：

**后端端口** (`backend/.env`)：
```env
PORT=3001  # 改成其他端口
```

**前端端口** (`frontend/vite.config.js`)：
```js
server: {
  port: 5174,  // 改成其他端口
}
```

### ❌ 配对失败

1. 检查后端日志，确认 FCM 监听是否启动
2. 尝试点击 **"重置 FCM 凭证"**
3. 重新启动后端服务
4. 确保游戏和 Dashboard 都在运行

### ❌ 连接失败

1. 确保服务器信息正确
2. 检查游戏是否在运行
3. 查看后端日志查找错误信息
4. 尝试断开后重新连接

### ❌ 设备无法控制

1. 确保设备已在游戏中配对
2. 检查设备是否有电源
3. 点击 **刷新按钮** 更新状态
4. 重新配对设备

## 进阶使用

### 多服务器管理

可以同时配对多个服务器：
1. 进入不同的游戏服务器
2. 分别进行配对
3. 在左侧列表切换服务器
4. 每个服务器独立管理设备和聊天

### 自动重连

- FCM 凭证会自动保存
- 下次启动会自动加载凭证
- 服务器信息会持久化存储
- 重启后自动恢复连接

### 数据备份

所有数据存储在 `backend/data/database.db`，可以：
- 定期备份这个文件
- 迁移到其他机器
- 恢复历史数据

## 需要帮助？

- 查看 [README.md](README.md) 了解更多功能
- 查看项目 Issues：https://github.com/liamcottle/rustplus.js/issues
- 查看 rustplus.js 文档：https://github.com/liamcottle/rustplus.js

祝你使用愉快！🎮
